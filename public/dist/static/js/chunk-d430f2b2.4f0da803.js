(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d430f2b2"],{"06e4":function(e,t,n){"use strict";var r=n("d904"),a=n.n(r);a.a},1018:function(e,t,n){},"13d5":function(e,t,n){"use strict";var r=n("23e7"),a=n("d58f").left,s=n("a640"),o=n("ae40"),i=s("reduce"),_=o("reduce",{1:0});r({target:"Array",proto:!0,forced:!i||!_},{reduce:function(e){return a(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"1f35":function(e,t,n){"use strict";var r=n("40b9");t["a"]=r["default"]},2748:function(e,t,n){},"29b9":function(e,t,n){},3521:function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"standard-table"},[n("div",{staticClass:"alert"},[e.selectedRows?n("a-alert",{attrs:{type:"info","show-icon":!0}},[n("div",{staticClass:"message",attrs:{slot:"message"},slot:"message"},[e._v(" 已选择 "),n("a",[e._v(e._s(e.selectedRows.length))]),e._v(" 项 "),n("a",{staticClass:"clear",on:{click:e.onClear}},[e._v("清空")]),e._l(e.needTotalList,(function(t,r){return[t.needTotal?n("div",{key:r},[e._v(" "+e._s(t.title)+"总计 "),n("a",[e._v(e._s(t.customRender?t.customRender(t.total):t.total))])]):e._e()]}))],2)]):e._e()],1),n("a-table",{attrs:{bordered:e.bordered,loading:e.loading,columns:e.columns,dataSource:e.dataSource,rowKey:e.rowKey,pagination:e.pagination,expandedRowKeys:e.expandedRowKeys,expandedRowRender:e.expandedRowRender,rowSelection:e.selectedRows?{selectedRowKeys:e.selectedRowKeys,onSelect:e.onSelect,onSelectAll:e.onSelectAll}:void 0},on:{change:e.onChange},scopedSlots:e._u([e._l(Object.keys(e.$scopedSlots).filter((function(e){return"expandedRowRender"!==e})),(function(t){return{key:t,fn:function(n,r,a){return[e._t(t,null,null,{text:n,record:r,index:a})]}}})),{key:e.$scopedSlots.expandedRowRender?"expandedRowRender":"",fn:function(t,n,r,a){return[e._t(e.$scopedSlots.expandedRowRender?"expandedRowRender":"",null,null,{record:t,index:n,indent:r,expanded:a})]}}],null,!0)},[e._l(Object.keys(e.$slots),(function(t){return n("template",{slot:t},[e._t(t)],2)}))],2)],1)},a=[],s=n("c1f7"),o=s["a"],i=(n("8298"),n("2877")),_=Object(i["a"])(o,r,a,!1,null,"6dc1dbc8",null);t["a"]=_.exports},"40b9":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-card",[n("div",[n("a-space",{staticClass:"operator"},[n("a-button",{attrs:{type:"primary"},on:{click:e.addNew}},[e._v("新增账单")])],1),n("a-modal",{attrs:{visible:e.createCourseFormVisible,width:600,title:"新增账单",footer:null},on:{cancel:e.closeAdd}},[n("AddInvoice",{ref:"AddInvoice",attrs:{visible:e.createCourseFormVisible,action_type:e.actionType,width:600},on:{"close-dialog":e.closeAdd,success:e.reload}})],1),n("standard-table",{attrs:{columns:e.columns,dataSource:e.dataSource,rowKey:e.rowKey,selectedRows:e.selectedRows,pagination:Object.assign({},e.pagination,{onChange:e.onPageChange})},on:{"update:selectedRows":function(t){e.selectedRows=t},"update:selected-rows":function(t){e.selectedRows=t}},scopedSlots:e._u([{key:"description",fn:function(t){var r=t.text;return n("div",{},[e._v(" "+e._s(r)+" ")])}},{key:"action",fn:function(t){t.text;var r=t.record;return 1===r.invoice_status?n("div",{},[n("a-popconfirm",{attrs:{title:e.$t("deleteConfirm")},on:{confirm:function(t){return e.invoiceSend(r.id)}}},[n("a",{attrs:{"a-icon":"",type:"delete"}},[e._v(e._s(e.$t("delete")))])])],1):e._e()}}],null,!0)})],1)])},a=[],s=(n("4de4"),n("c740"),n("b680"),n("3521")),o=n("b775"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-card",{attrs:{"body-style":{width:"600px"},bordered:!1}},[n("a-form",{ref:"form"},[n("a-form-item",{attrs:{label:e.$t("course_name"),labelCol:{span:7,style:{paddingTop:"10px"}},wrapperCol:{span:10}}},[n("CourseSelect",{ref:"CourseSelect",model:{value:e.selectCourseValue,callback:function(t){e.selectCourseValue=t},expression:"selectCourseValue"}})],1),n("a-form-item",{attrs:{label:e.$t("student_name"),labelCol:{span:7,style:{paddingTop:"10px"}},wrapperCol:{span:10}}},[n("StudentSelect",{ref:"studentSelect",attrs:{students:e.students},model:{value:e.selectStudentValue,callback:function(t){e.selectStudentValue=t},expression:"selectStudentValue"}})],1),n("a-form-item",{staticStyle:{"margin-top":"24px"},attrs:{wrapperCol:{span:10,offset:10}}},[n("a-button",{attrs:{type:"primary",disabled:e.isSubmitDisabled},on:{click:e.submitForm}},[e._v(e._s(e.$t("submit")))])],1)],1)],1)},_=[],c=(n("4160"),n("159b"),n("3af3")),u=n("3042"),d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-select",{staticStyle:{width:"100%","margin-top":"16px","margin-bottom":"8px","margin-right":"8px"},model:{value:e.selectedValue,callback:function(t){e.selectedValue=t},expression:"selectedValue"}},e._l(e.students,(function(t){return n("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(" "+e._s(t.name)+" ")])})),1)},l=[],f=(n("a434"),n("b0c0"),n("a9e3"),n("3f45")),p={name:"StudentSelect",props:{students:{type:Array,required:!0,default:function(){return[]}},value:{type:[String,Number],required:!0},filterConditions:{type:Object,default:function(){return{}}}},computed:{selectedValue:{get:function(){return this.value},set:function(e){this.$emit("input",e)}}},methods:{getStudent:function(e){if(this.students.length>0)return this.students;var t=this;return Object(f["a"])("",e).then((function(e){var n=e.data;n.code>0?this.$message.error(n.message):n.data.forEach((function(e){t.students.push({id:e.id,name:e.name})}))})),this.students},reset:function(e){this.students.splice(0,this.students.length),this.getStudent(e)}}},m=p,h=(n("c813"),n("2877")),b=Object(h["a"])(m,d,l,!1,null,"a9a1b3de",null),v=b.exports,g=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-select",{staticStyle:{width:"100%","margin-top":"16px","margin-bottom":"8px","margin-right":"8px"},model:{value:e.selectedValue,callback:function(t){e.selectedValue=t},expression:"selectedValue"}},e._l(e.courses,(function(t){return n("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(" "+e._s(t.name)+" ")])})),1)},w=[],y=(n("a623"),n("b64b"),{name:"CourseSelect",props:{courses:{type:Array,default:function(){return[]}},value:{type:[String,Number],required:!0},filterConditions:{type:Object,default:function(){return{}}}},mounted:function(){this.getCourses()},computed:{selectedValue:{get:function(){return this.value},set:function(e){this.$emit("input",e)}},filteredCourses:function(){var e=this;return this.courses.filter((function(t){return Object.keys(e.filterConditions).every((function(n){return t[n]===e.filterConditions[n]}))}))}},methods:{getCourses:function(){if(this.courses.length>0)return this.courses;var e=this;return Object(u["c"])("").then((function(t){var n=t.data;n.code>0?this.$message.error(n.message):n.data.forEach((function(t){e.courses.push({id:t.id,name:t.name})}))})),this.courses}}}),E=y,O=(n("06e4"),Object(h["a"])(E,g,w,!1,null,"d24c5ee8",null)),R=O.exports,S=n("f81a"),C={components:{StudentSelect:v,CourseSelect:R,"a-form":c["a"],"a-form-item":c["a"].Item},props:{action_type:{type:String,required:!0,default:"create"}},name:"AddInvoice",i18n:n("d18f"),data:function(){return{visible:!1,form:this.$form.createForm(this,{name:"add_course"}),formFields:{course_sn:"",course_name:"",course_fee:null,course_month:null,course_month_str:""},isSubmitting:!1,students:[],selectCourseValue:"",selectStudentValue:""}},watch:{selectCourseValue:{immediate:!0,handler:function(e){this.getStudent(e)}}},computed:{isSubmitDisabled:function(){return this.isSubmitting||!(this.selectCourseValue&&this.selectStudentValue)}},methods:{submitForm:function(){var e=this;this.form.validateFields((function(t){t||e.createInvoice(e.selectCourseValue,e.selectStudentValue,"")}))},createInvoice:function(e,t,n){var r=this;r.isSubmitting=!0,Object(S["a"])(e,t,n).then((function(e){if(r.isSubmitting=!1,e.data.code>0)return r.$message.error(e.data.message),!1;r.$message.success(e.data.message),r.$emit("success"),r.$emit("close-dialog")}))},getStudent:function(e){var t=this;Object(u["d"])(e).then((function(e){var n=e.data;if(n.code>0)t.$message.error(n.message);else{var r=[];n.data.forEach((function(e){r.push(e.id)})),t.$refs.studentSelect.reset(r)}}))},clear:function(){this.form.resetFields(),this.selectCourseValue="",this.selectStudentValue=""}},mounted:function(){}},j=C,P=(n("9cb0"),Object(h["a"])(j,i,_,!1,null,"fba65dfa",null)),x=P.exports,D=n("1f35"),I=[{title:"账单Id",dataIndex:"id"},{title:"课程编号",dataIndex:"course_sn"},{title:"课程月份",dataIndex:"course_year_month"},{title:"课程名称",dataIndex:"course_name"},{title:"账单费用",dataIndex:"fee",customRender:function(e){return(e/100).toFixed(2)+"元"}},{title:"学生姓名",dataIndex:"student_name"},{title:"学生编号",dataIndex:"student_sn"},{title:"账单状态",dataIndex:"invoice_status",customRender:function(e){switch(e){case 1:return"待发送";case 2:return"待支付";case 3:return"已支付";default:return"未知状态"}},sorter:!0},{title:"账单时间",dataIndex:"create_at",sorter:!0},{title:"操作",scopedSlots:{customRender:"action"}}],M={name:"InvoiceList",computed:{invoice:function(){return D["a"]},form:function(){return this.$form.createForm(this,{name:"add_invoice"})}},i18n:n("75b7"),components:{AddInvoice:x,StandardTable:s["a"]},data:function(){return{advanced:!0,columns:I,rowKey:"id",dataSource:[],selectedRows:[],pagination:{current:1,pageSize:10,total:0},createCourseFormVisible:!1,createStudentFormVisible:!1,actionType:"create"}},authorize:{deleteRecord:"delete"},mounted:function(){this.load()},methods:{load:function(){var e=this;Object(o["f"])("https://poper-ops-interview-02.herokuapp.com/api/invoice/teacher-list","get",{page:this.pagination.current,pageSize:this.pagination.pageSize}).then((function(t){var n,r,a=null!==(n=null===t||void 0===t||null===(r=t.data)||void 0===r?void 0:r.data)&&void 0!==n?n:{},s=a.list,o=a.page,i=a.pageSize,_=a.total;e.dataSource=s,e.pagination.current=o,e.pagination.pageSize=i,e.pagination.total=_}))},reload:function(){this.load()},remove:function(){var e=this;this.dataSource=this.dataSource.filter((function(t){return-1===e.selectedRows.findIndex((function(e){return e.key===t.key}))})),this.selectedRows=[]},addNew:function(){var e=this;this.createCourseFormVisible=!0,this.$nextTick((function(){e.$refs.AddInvoice&&"function"===typeof e.$refs.AddInvoice.clear&&e.$refs.AddInvoice.clear()}))},onPageChange:function(e,t){this.pagination.current=e,this.pagination.pageSize=t,this.load()},closeAdd:function(){this.createCourseFormVisible=!1},invoiceSend:function(e){var t=this;Object(S["c"])(e).then((function(e){0===e.data.code?(t.$message.success(e.data.message),t.reload()):t.$message.error(e.data.message)}))},toggle:function(e){var t=this.dataSource.filter((function(t){return t.key===e}))[0];t.editable=!t.editable}}},A=M,k=(n("d926"),Object(h["a"])(A,r,a,!1,null,"4893b609",null));t["default"]=k.exports},"75b7":function(e,t){e.exports={messages:{CN:{delete:"发送",deleteConfirm:"确认需要发送账单给该学生么"}}}},8298:function(e,t,n){"use strict";var r=n("efe1"),a=n.n(r);a.a},"9cb0":function(e,t,n){"use strict";var r=n("2748"),a=n.n(r);a.a},a623:function(e,t,n){"use strict";var r=n("23e7"),a=n("b727").every,s=n("a640"),o=n("ae40"),i=s("every"),_=o("every");r({target:"Array",proto:!0,forced:!i||!_},{every:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}})},c1f7:function(module,__webpack_exports__,__webpack_require__){"use strict";var core_js_modules_es_array_concat__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("99af"),core_js_modules_es_array_concat__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_array_concat__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es_array_filter__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("4de4"),core_js_modules_es_array_filter__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es_array_filter__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("4160"),core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es_array_map__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("d81d"),core_js_modules_es_array_map__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es_array_map__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es_array_reduce__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("13d5"),core_js_modules_es_array_reduce__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es_array_reduce__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_es_object_values__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("07ac"),core_js_modules_es_object_values__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_es_object_values__WEBPACK_IMPORTED_MODULE_5__),core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("159b"),core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_6__),_Users_desert_project_poper_vue_antd_edu_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("5530"),_Users_desert_project_poper_vue_antd_edu_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("2909");__webpack_exports__["a"]={name:"StandardTable",props:{bordered:Boolean,loading:[Boolean,Object],columns:Array,dataSource:Array,rowKey:{type:[String,Function],default:"key"},pagination:{type:[Object,Boolean],default:!0},selectedRows:Array,expandedRowKeys:Array,expandedRowRender:Function},data:function(){return{needTotalList:[]}},methods:{equals:function(e,t){if(e===t)return!0;var n=this.rowKey;return n&&"string"===typeof n?e[n]===t[n]:!(!n||"function"!==typeof n)&&n(e)===n(t)},contains:function(e,t){if(!e||0===e.length)return!1;for(var n=this.equals,r=0;r<e.length;r++)if(n(e[r],t))return!0;return!1},onSelectAll:function(e,t){var n=this,r=this.getKey,a=this.contains,s=this.dataSource.filter((function(e){return!a(t,e,n.rowKey)})),o=this.selectedRows.filter((function(e){return!a(s,e,n.rowKey)})),i={};o.forEach((function(e){return i[r(e)]=e})),t.forEach((function(e){return i[r(e)]=e}));var _=Object.values(i);this.$emit("update:selectedRows",_),this.$emit("selectedRowChange",_.map((function(e){return r(e)})),_)},getKey:function(e){var t=this.rowKey;if(t&&e)return"string"===typeof t?e[t]:t(e)},onSelect:function(e,t){var n=this.equals,r=this.selectedRows,a=this.getKey,s=t?[].concat(Object(_Users_desert_project_poper_vue_antd_edu_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_8__["a"])(r),[e]):r.filter((function(t){return!n(t,e)}));this.$emit("update:selectedRows",s),this.$emit("selectedRowChange",s.map((function(e){return a(e)})),s)},initTotalList:function(e){return e.filter((function(e){return e.needTotal})).map((function(e){return Object(_Users_desert_project_poper_vue_antd_edu_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_7__["a"])(Object(_Users_desert_project_poper_vue_antd_edu_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_7__["a"])({},e),{},{total:0})}))},onClear:function(){this.$emit("update:selectedRows",[]),this.$emit("selectedRowChange",[],[]),this.$emit("clear")},onChange:function(e,t,n,r){var a=r.currentDataSource;this.$emit("change",e,t,n,{currentDataSource:a})}},created:function(){this.needTotalList=this.initTotalList(this.columns)},watch:{selectedRows:function selectedRows(_selectedRows2){this.needTotalList=this.needTotalList.map((function(item){return Object(_Users_desert_project_poper_vue_antd_edu_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_7__["a"])(Object(_Users_desert_project_poper_vue_antd_edu_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_7__["a"])({},item),{},{total:_selectedRows2.reduce((function(sum,val){var v;try{v=val[item.dataIndex]?val[item.dataIndex]:eval("val.".concat(item.dataIndex))}catch(_){v=val[item.dataIndex]}return v=isNaN(parseFloat(v))?0:parseFloat(v),sum+v}),0)})}))}},computed:{selectedRowKeys:function(){var e=this;return this.selectedRows.map((function(t){return e.getKey(t)}))}}}},c813:function(e,t,n){"use strict";var r=n("1018"),a=n.n(r);a.a},d18f:function(e,t){e.exports={messages:{CN:{course_sn:"课程编号",course_name:"课程名称",student_name:"学生姓名",course_fee:"课程费用",course_month:"课程年月",course_name_placeholder:"请输入课程编号",course_sn_placeholder:"请输入课程标号",course_fee_placeholder:"请输入课程费用",course_month_placeholder:"请选择课程年月",submit:"保存",cancel:"取消",save:"取消"}}}},d58f:function(e,t,n){var r=n("1c0b"),a=n("7b0b"),s=n("44ad"),o=n("50c4"),i=function(e){return function(t,n,i,_){r(n);var c=a(t),u=s(c),d=o(c.length),l=e?d-1:0,f=e?-1:1;if(i<2)while(1){if(l in u){_=u[l],l+=f;break}if(l+=f,e?l<0:d<=l)throw TypeError("Reduce of empty array with no initial value")}for(;e?l>=0:d>l;l+=f)l in u&&(_=n(_,u[l],l,c));return _}};e.exports={left:i(!1),right:i(!0)}},d904:function(e,t,n){},d926:function(e,t,n){"use strict";var r=n("29b9"),a=n.n(r);a.a},efe1:function(e,t,n){},f81a:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return _})),n.d(t,"b",(function(){return u}));n("96cf");var r=n("1da1"),a=n("7424"),s=n("b775");function o(e,t,n){return i.apply(this,arguments)}function i(){return i=Object(r["a"])(regeneratorRuntime.mark((function e(t,n,r){var o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o={course_id:t,student_id:n},r.length>0&&(o.remark=r),e.abrupt("return",Object(s["f"])(a["InvoiceCreate"],s["a"].POST,o));case 3:case"end":return e.stop()}}),e)}))),i.apply(this,arguments)}function _(e){return c.apply(this,arguments)}function c(){return c=Object(r["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n={invoice_id:t},e.abrupt("return",Object(s["f"])(a["InvoiceSendUri"],s["a"].POST,n));case 2:case"end":return e.stop()}}),e)}))),c.apply(this,arguments)}function u(e){return d.apply(this,arguments)}function d(){return d=Object(r["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n={invoice_id:t},e.abrupt("return",Object(s["f"])(a["InvoiceCreatePayUri"],s["a"].POST,n));case 2:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}}}]);